{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/LightningInspectorInjectedScript.js","webpack:///./src/aura/ControlCharacters.js","webpack:///./src/aura/JsonSerializer.js","webpack:///./src/aura/gatherer/ComponentSerializer.js","webpack:///./src/aura/gatherer/unStrictApis.js"],"names":["$Aura","actions","styleRuleId","document","getElementById","rules","style","createElement","id","textContent","innerText","head","appendChild","body","addEventListener","removeClassHandler","event","removeClassName","addClassName","element","target","classList","remove","$Symbol","Symbol","for","Inspector","AuraInspector","init","window","LightningStylesheets","subscribers","PUBLISH_KEY","PUBLISH_BATCH_KEY","BOOTSTRAP_KEY","postMessagesQueue","batchPostId","lastItemInspected","countMap","instrumented","actionsWatched","actionsToWatch","addRightClickObserver","subscribe","nodeType","publish","getAttribute","instrument","AuraInspector_OnPanelLoad","bind","AuraInspector_OnAddHighlightDomNode","AuraInspector_OnRemoveHighlightDomNode","AuraInspector_OnActionToWatchEnqueue","AuraInspector_RemoveActionFromWatch","AuraInspector_RemoveActionsFromWatch","$A","getContext","readyState","search","action","term","all","postMessage","location","origin","installOverride","e","bootstrapCounters","instrumentActions","bootstrapPerfDevTools","bootstrapEventInstrumentation","bootstrapTransactionReporting","PerfDevTools","bootstrap","OnEnqueueAction","OnAbortAction","OnActionRunDeprecated","Action_OnFinishAction","ClientService_OnSend","ClientService_OnDecode","config","oldResponse","noStrip","length","console","warn","call","response","oldResponseText","newResponseText","hasWatchedActions","actionId","includes","startsWith","actionWatched","actionsObj","getActionsFromResponseText","responseActions","actionFound","restOfActions","filter","current","nextError","state","error","returnValue","actionsEndIndex","indexOf","JSON","stringify","concat","substring","idtoWatch","performance","now","newHttpRequest","nextResponse","responseModified","Object","assign","util","apply","byChaosRun","addMessageAndStackToResponse","message","stack","actionsStartIdx","actionsStrInResponse","replace","lastIndexOf","parse","getWatchedAction","isWatchingForAction","reference","name","actionName","isAction","getDef","toString","getOwnPropertyNames","isWatchingForActions","setWatchedActionAsProcessed","setWatchAsProcessed","setWatchedAction","getId","watchAction","cancelWatchOfAction","hasOwnProperty","cancelWatchOfAllActions","key","data","push","undefined","sendQueuedPostMessages","callback","unsubscribe","listeners","item","accessTrap","getRootComponents","ComponentSerializer","getComponent","componentId","options","count","getCount","clearCount","Handle_OnPostMessage","callSubscribers","c","getComponentForLtngOut","components","owner","getOwner","isInstanceOf","forEach","requestIdleCallback","sendQueuedPostMessagesCallback","requestAnimationFrame","button","hasAttribute","parentNode","wrapFunction","methodName","newFunction","original","arguments","globalId","addedStyleRules","className","previous","getElementsByClassName","d","cmp","isValid","elements","getElements","add","context","startCounts","ret","isServerAction","getState","isFromStorage","JsonSerializer","getReturnValue","getError","created","howDidWeModifyResponse","alreadyAdded","actionIsStorable","actionsStorage","storageService","getStorage","actionStorageKey","get","then","substr","auraXHR","method","actionToWatch","scope","getParams","isAbortable","isStorable","isBackground","isRefreshAction","getStorageKey","getGlobalId","startTime","getName","Array","prototype","shift","Component","originalRender","render","getSuperDef","getDescriptor","getQualifiedName","getCallback","UnStrictApis","OnEventFire","output","componentToJSON","toJSON","json","value","isComponent","Function","metricsService","enablePlugins","transactionStart","onTransactionEnd","transaction","setTimeout","onTransactionsKilled","transactions","PerfDevToolsEnabled","OPTIONS","componentCreation","componentRendering","timelineMarks","CMP_CREATE_MARK","START_SUFIX","END_SUFIX","CMP_CREATE_END","SAMPLING_INTERVAL","cfg","_initializeOptions","_hooks","collector","rendering","_initializeHooks","clearMarks","marks","_resetCollector","opts","_initializeHooksComponentCreation","_createNode","mark","timestamp","type","i","_hookOverride","getComponentCreationProfile","_generateCPUProfilerDataFromMarks","args","slice","cmpConfig","descriptor","isString","newCmp","status","_hookMethod","host","self","hook","isArray","componentDef","result","nextId","logTree","hashCode","hash","chr","len","charCodeAt","Math","abs","generateNode","functionName","random","scriptId","url","details","lineNumber","columnNumber","hitCount","hit","callUID","children","deoptReason","endText","endTime","markLength","duration","sampling","root","idle","_startTime","generateTimestamps","diff","ticks","round","time","ts","generateSamples","size","samples","join","split","currentIndex","idleHits","calculateTimesForNode","node","_idleHits","j","max","tmp","tmpNode","_endTime","_totalTime","_childrenTime","reduce","p","_selfTime","floor","_cmpId","_childComponentCount","toFixed","unshift","ControlCharacters","isComponentId","COMPONENT_CONTROL_CHAR","isActionId","ACTION_CONTROL_CHAR","getCleanId","ESCAPE_CHAR","freeze","increment","originalValue","doNotSerialize","visited","Set","toJSONCmp","escape","Error","HTMLElement","attributes","domOutput","attribute","tagName","Text","nodeValue","isExpression","has","isSealed","isEmpty","$serId$","resolve","object","serializationMap","Map","unresolvedReferences","innerResolve","parent","property","$serRefId$","set","unresolved","topLevelDomNodes","rootNodes","app","getRoot","querySelectorAll","map","parentNodes","component","configuration","isTypeModule","isModule","_$getSelfGlobalId$","isRendered","isConcrete","getLocalId","valueProviders","getValueProvider","getAttributeValueProvider","getComponentValueProvider","auraError","getAttributeDefs","accessCheckFailed","each","attributeDef","rawValue","_$getRawValue$","expressions","supers","superComponent","getSuper","elementCount","getElementsByTagName","model","getModel","handlers","events","getEventDispatcher","apiSupported","eventName","valueProvider","$type$","values","keys","provider","getPrimaryProviderKeys"],"mappings":"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","file":"LightningInspectorInjectedScript.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n","import ComponentSerializer from \"./aura/gatherer/ComponentSerializer.js\";\nimport JsonSerializer from \"./aura/JsonSerializer.js\";\nimport UnStrictApis from \"./aura/gatherer/unStrictApis.js\";\n\n//*** Used by Aura Inspector\n// This is injected in the DOM directly via <script> injection\n    const $Aura = {};\n\n    // Do NOT use this pattern, it's tech-debt and should be removed. Add all logic to AuraInspector.\n    $Aura.actions = {\n        \"AuraDevToolService.AddStyleRules\": function() {\n            var styleRuleId = \"AuraDevToolService.AddStyleRules\";\n\n            // Already added\n            if(document.getElementById(styleRuleId)) { return; }\n\n            var rules = `\n                .auraDevToolServiceHighlight3:before{\n                   position:absolute;\n                   display:block;\n                   width:100%;\n                   height:100%;\n                   z-index: 10000;\n                   background-color:#006699;\n                   opacity:.3;\n                   content:' ';\n                   border : 2px dashed white;\n                }\n                .auraDevToolServiceHighlight4.auraDevToolServiceHighlight3:before {\n                   opacity: 0;\n                   transition: opacity 2s;\n                }\n            `;\n\n            var style = document.createElement(\"style\");\n                style.id = styleRuleId;\n                style.textContent = rules;\n                style.innerText = rules;\n\n            var head = document.head;\n                head.appendChild(style);\n\n\n            document.body.addEventListener(\"transitionend\", function removeClassHandler(event) {\n                var removeClassName = \"auraDevToolServiceHighlight3\";\n                var addClassName = \"auraDevToolServiceHighlight4\";\n                var element = event.target;\n                if (element) {\n                    element.classList.remove(removeClassName);\n                    element.classList.remove(addClassName);\n                }\n            });\n        }\n    };\n\n    var $Symbol = Symbol.for(\"AuraDevTools\");\n\n    // Communicate directly with the aura inspector\n    $Aura.Inspector = new AuraInspector();\n    $Aura.Inspector.init();\n\n    // Attach to the global object so our integrations can access it, but\n    // use a symbol so it doesn't create a global property.\n    window[$Symbol] = $Aura;\n\n    function LightningStylesheets() {\n        \n\n        this.init = function() {\n\n        };\n    }\n\n    function AuraInspector() {\n        var subscribers = {};\n        var PUBLISH_KEY = \"AuraInspector:publish\";\n        var PUBLISH_BATCH_KEY = \"AuraInspector:publishbatch\";\n        var BOOTSTRAP_KEY = \"AuraInspector:bootstrap\";\n        var postMessagesQueue = [];\n        var batchPostId = null;\n        var lastItemInspected;\n        var countMap = {};\n        var instrumented = {\n            \"actions\": false,\n            \"all\": false\n        };\n\n        // For dropping actions\n        var actionsWatched = {};\n        var actionsToWatch = {};\n\n        this.init = function() {\n            // Add Rightclick handler. Just track what we rightclicked on.\n            addRightClickObserver();\n\n            this.subscribe(\"AuraInspector:ContextElementRequest\", () => {\n                if(lastItemInspected && lastItemInspected.nodeType === 1) {\n                    this.publish(\"AuraInspector:ShowComponentInTree\", lastItemInspected.getAttribute(\"data-aura-rendered-by\"));\n                }\n            });\n\n            // Aura's present, our script is present, bootstrap!\n            this.subscribe(\"AuraInspector:OnAuraInitialized\", () => {\n                this.instrument();\n                this.subscribe(\"AuraInspector:OnPanelConnect\", AuraInspector_OnPanelLoad.bind(this));\n            });\n\n            // Component tree hovering to show the element in the dom.\n            this.subscribe(\"AuraInspector:OnHighlightComponent\", AuraInspector_OnAddHighlightDomNode);\n            this.subscribe(\"AuraInspector:OnHighlightComponentEnd\", AuraInspector_OnRemoveHighlightDomNode);\n\n            // Action dropping and modifying\n            this.subscribe(\"AuraInspector:OnActionToWatchEnqueue\", AuraInspector_OnActionToWatchEnqueue.bind(this));\n            this.subscribe(\"AuraInspector:OnActionToRemoveFromWatchEnqueue\", AuraInspector_RemoveActionFromWatch.bind(this));\n            this.subscribe(\"AuraInspector:OnActionToWatchClear\", AuraInspector_RemoveActionsFromWatch.bind(this));\n\n            // Aura is present and the root has already been initialized.\n            if(window.$A && window.$A.getContext && !!window.$A.getContext()) {\n                this.instrument();\n                this.publish(\"AuraInspector:OnAuraInitialized\", \"InjectedScript: Aura Present already during load.\" );\n            }\n\n            if(document.readyState === \"complete\") {\n                if(!window.$A) {\n                    this.publish(\"AuraInspector:OnAuraUnavailable\", {});\n                }\n            } else {\n                window.addEventListener(\"load\", () => {\n                    if(!window.$A) {\n                        this.publish(\"AuraInspector:OnAuraUnavailable\", {});\n                    }\n                });\n            }\n\n            this.publish(\"AuraInspector:OnInjectionScriptInitialized\")\n        };\n\n        this.search = function(action, term) {\n            if(action === \"performSearch\") {\n                this.publish(\"AuraInspector:Search\", term);\n            } else {\n                this.publish(\"AuraInspector:CancelSearch\")\n            }\n        };\n\n        this.instrument = function() {\n            if(instrumented.all) {\n                // If you close the panel, then reopen it, the bootstrap will have already happened\n                // on the page. But the inspector doesn't know that, we still need to communicate\n                // to it that we're done. So we always post the bootstrap back.\n                window.postMessage({\n                    \"action\": \"AuraInspector:bootstrap\",\n                    \"key\": \"AuraInspector:bootstrap\",\n                    \"data\": \"InjectedScript: Aura is already present at initialization, calling bootstrap.\"\n                }, window.location.origin);\n                return;\n            }\n\n            if (typeof $A === \"undefined\" || !($A.getContext && $A.getContext())) {\n                // Aura isn't ready yet.\n                return;\n            }\n\n            // Try catches for branches that don't have the overrides\n            // This instrument is where we add the methods _$getRawValue$() and _$getSelfGlobalId$() to the\n            // component prototype. This allowed us to move to outputing the component from injected code, vs code in the framework.\n            // Would be nice to get rid of needing this.\n            try {\n                $A.installOverride(\"outputComponent\", function(){});\n            } catch(e){}\n\n            try {\n                // Counts how many times various things have happened.\n                bootstrapCounters();\n            } catch(e){}\n\n            try {\n                // Actions Tab\n                this.instrumentActions();\n             } catch(e){\n             }\n             try {\n                // Perf Tab\n                bootstrapPerfDevTools();\n             } catch(e){\n\n             }\n             try {\n                // Events Tab\n                bootstrapEventInstrumentation();\n            } catch(e){}\n\n            try {\n                bootstrapTransactionReporting();\n            } catch(e){}\n\n            // Need a way to conditionally do this based on a user setting.\n            $A.PerfDevTools.init();\n\n            window.postMessage({\n                \"action\": \"AuraInspector:bootstrap\",\n                \"key\":\"AuraInspector:bootstrap\",\n                \"data\": \"InjectedScript: $Aura.Inspector.instrument()\"\n            }, window.location.origin);\n\n            instrumented.all = true;\n        };\n\n        // Just incase for legacy, remove say 210\n        this.bootstrap = this.instrument;\n\n        this.instrumentActions = function() {\n            if(instrumented.actions) {\n                return;\n            }\n\n            $A.installOverride(\"enqueueAction\", OnEnqueueAction);\n            //$A.installOverride(\"Action.finishAction\", OnFinishAction);\n            $A.installOverride(\"Action.abort\", OnAbortAction);\n            $A.installOverride(\"Action.runDeprecated\", OnActionRunDeprecated);\n            $A.installOverride(\"Action.finishAction\", Action_OnFinishAction.bind(this));\n            $A.installOverride(\"ClientService.send\", ClientService_OnSend.bind(this));\n            $A.installOverride(\"ClientService.decode\", ClientService_OnDecode.bind(this));\n\n            instrumented.actions = true;\n\n            //oldResponse: XMLHttpRequest\n            //actionsFromAuraXHR: AuraXHR keep an object called actions, it has all actions client side are waiting for response, a map between actionId and action.\n            function ClientService_OnDecode(config, oldResponse, noStrip) {\n                //var response = oldResponse[\"response\"];\n                if(!oldResponse[\"response\"] || oldResponse[\"response\"].length == 0) {\n                    console.warn(\"AuraInspectorInjectedScript.onDecode received a bad response.\", oldResponse);\n                    return config[\"fn\"].call(config[\"scope\"], oldResponse, noStrip);\n                }\n\n                //modify response if we find the action we are watching\n                var response = oldResponse[\"response\"];\n                var oldResponseText = oldResponse[\"responseText\"];\n                var newResponseText = oldResponseText;\n                // var responseModified = false;//if we modify the response, set this to true\n                // var responseWithError = false;//if we send back error response, set this to true\n                // var responseWithIncomplete = false;//if we want to kill the action, set this to true\n\n                if(this.hasWatchedActions()) {\n                    try {\n                        for(var actionId in actionsWatched) {\n                            if(!oldResponseText.includes(actionId) || !oldResponseText.startsWith(\"while(1);\")) {\n                                continue;\n                            }\n\n                            var actionWatched = actionsWatched[actionId];\n                            var actionsObj = getActionsFromResponseText(oldResponseText);\n                            var responseActions = actionsObj && actionsObj.actions || [];\n                            \n                            var actionFound;\n                            var restOfActions = responseActions.filter((current) => {\n                                if(current.id === actionId) {\n                                    actionFound = current; \n                                    return false;\n                                } else {\n                                    return true;\n                                }\n                            });\n                            \n                            // We have not yet found an action in the existing set we want to modify\n                            if(!actionFound) {\n                                continue;\n                            }\n                            //we would like to return error response\n                            if(actionWatched.nextError) {\n                                actionFound.state = \"ERROR\";\n                                actionFound.error = [actionWatched.nextError];\n                                actionFound.returnValue = null;\n                                var actionsEndIndex = oldResponseText.indexOf(\"context\\\"\");\n                                newResponseText = \"while(1);\\n{\\\"actions\\\":\"+JSON.stringify(restOfActions.concat(actionFound))+\",\\\"\"+oldResponseText.substring(actionsEndIndex,oldResponseText.length);\n                                //move the actionCard from watch list to Processed\n                                //this will call AuraInspectorActionsView_OnActionStateChange in AuraInspectorActionsView.js\n                                $Aura.Inspector.publish(\"AuraInspector:OnActionStateChange\", {\n                                        \"id\": actionId,\n                                        \"idtoWatch\": actionWatched.idtoWatch,\n                                        \"state\": \"RESPONSEMODIFIED\",\n                                        \"sentTime\": performance.now()//do we need this?\n                                });\n\n                                const newHttpRequest = {\n                                    \"status\": 200,\n                                    \"response\": newResponseText,\n                                    \"responseText\": newResponseText,\n                                    \"$hasError\": true\n                                };\n                                \n                                return config[\"fn\"].call(config[\"scope\"], newHttpRequest, noStrip);\n                            } \n                            //we would like to return non-error response\n                            else if(actionWatched.nextResponse) {\n                                var responseModified = Object.assign(actionFound.returnValue, actionWatched.nextResponse);\n                                if(responseModified) {\n                                    actionFound.returnValue = responseModified;\n                                    var actionsEndIndex = oldResponseText.indexOf(\"context\\\"\");\n                                    newResponseText = \"while(1);\\n{\\\"actions\\\":\"+JSON.stringify(restOfActions.concat(actionFound))+\",\\\"\"+oldResponseText.substring(actionsEndIndex,oldResponseText.length);\n\n                                    //move the actionCard from watch list to Processed\n                                    //this will call AuraInspectorActionsView_OnActionStateChange in AuraInspectorActionsView.js\n                                    $Aura.Inspector.publish(\"AuraInspector:OnActionStateChange\", {\n                                            \"id\": actionId,\n                                            \"idtoWatch\": actionWatched.idtoWatch,\n                                            \"state\": \"RESPONSEMODIFIED\",\n                                            \"sentTime\": performance.now()//do we need this?\n                                    });\n                                    \n                                    const newHttpRequest = Object.assign($A.util.apply({}, oldResponse), {\n                                        \"response\": newResponseText,\n                                        \"responseText\": newResponseText,\n                                        \"$isModified\": true\n                                    });\n\n                                    return config[\"fn\"].call(config[\"scope\"], newHttpRequest, noStrip);\n                                }\n                            } \n                            //we would like to kill action, return incomplete\n                            else {\n                                //responseWithIncomplete = true;\n                                //move the actionCard from watch list to Processed\n                                //this will call AuraInspectorActionsView_OnActionStateChange in AuraInspectorActionsView.js\n                                $Aura.Inspector.publish(\"AuraInspector:OnActionStateChange\", {\n                                        \"id\": actionId,\n                                        \"idtoWatch\": actionWatched.idtoWatch,\n                                        \"state\": \"RESPONSEMODIFIED\",\n                                        \"sentTime\": performance.now(),//do we need this?\n                                        \"byChaosRun\": actionWatched.byChaosRun\n                                });\n                                if(actionWatched.byChaosRun) {\n                                    $Aura.Inspector.publish(\"AuraInspector:OnCreateChaosCard\", {\"message\": \"Drop action \"+actionWatched.id + \", the old actionId from replay: \"+actionWatched.idtoWatch} );\n                                    if(actionWatched.id === actionWatched.idtoWatch) {\n                                        console.warn(\"The action in your replay has the same id as the action being dropped, this will confuse ActionTab, as it use actionId to find and move actionCard around. Please change action id in your replay file to something else, like 9999 :-) \");\n                                    }\n                                }\n\n                                const newHttpRequest = {\n                                    \"status\": 0,\n                                    \"$isIncomplete\": true\n                                };\n                                \n                                return config[\"fn\"].call(config[\"scope\"], newHttpRequest, noStrip);\n                            }\n                        \n                        }\n                    } catch(e) {\n                        console.warn(\"get response we cannot parse with JSON.parse, skip\", oldResponse, e);\n                        return config[\"fn\"].call(config[\"scope\"], oldResponse, noStrip);\n                    }\n                }\n\n                /** CHAOS **/\n                // if($Sfdc.chaos.shouldWeDropAction()) {\n                //     //if we are in a new chaos run and user would like to drop action randomly\n                //     responseWithIncomplete = $Sfdc.chaos.randomlyDropAction(responseWithIncomplete, oldResponseText); \n                // }\n\n                // if($Sfdc.chaos.shouldWeErrorResponseAction()) {\n                //     //if we are in a new chaos run and we would like to return error response randomly\n                //     const resObj = $Sfdc.chaos.randomlyReturnErrorResponseForAction(responseWithIncomplete, oldResponseText);\n                //     responseWithError = resObj.responseWithError;\n                //     newResponseText = resObj.newResponseText;\n                // }\n                /** End Chaos **/\n                \n                // if(responseWithIncomplete) {\n                //     const newHttpRequest = {\n                //         \"status\": 0,\n                //         \"$isIncomplete\": true\n                //     };\n                    \n                //     return config[\"fn\"].call(config[\"scope\"], newHttpRequest, noStrip);\n                // }\n                // else if(responseModified === true) {\n                //     const newHttpRequest = Object.assign({}, oldResponse, {\n                //         \"response\": newResponseText,\n                //         \"responseText\": newResponseText,\n                //         \"$isModified\": true\n                //     });\n                //     newHttpRequest[\"response\"] = newResponseText;\n                //     newHttpRequest[\"responseText\"] = newResponseText;\n\n                //     return config[\"fn\"].call(config[\"scope\"], newHttpRequest, noStrip);\n                // } else if (responseWithError === true) {\n                //     const newHttpRequest = {\n                //         \"status\": 500, // As long as it's not 200\n                //         \"response\": newResponseText,\n                //         \"responseText\": newResponseText,\n                //         \"$hasError\": true\n                //     };\n                    \n                //     return config[\"fn\"].call(config[\"scope\"], newHttpRequest, noStrip);\n                // } else {\n                //     //nothing happended, just send back oldResponse\n                //     return config[\"fn\"].call(config[\"scope\"], oldResponse, noStrip);\n                // }\n\n                //nothing happended, just send back oldResponse\n                return config[\"fn\"].call(config[\"scope\"], oldResponse, noStrip);\n            }\n\n            function addMessageAndStackToResponse(response, message, stack) {\n                var actionsStartIdx = response.indexOf(\"actions\");\n                if(actionsStartIdx>0) {\n                    return response.substring(0, actionsStartIdx-1)+\"\\\"message\\\":\\\"\"+message+\"\\\",\\\"stack\\\":\\\"\"+stack+\"\\\",\" + response.substring(actionsStartIdx-1, response.length);\n                } else {\n                    return response;\n                }\n            }\n\n            function getActionsFromResponseText(response) {\n                var actionsStartIdx = response.indexOf(\"actions\");\n                var actionsEndIndex = response.indexOf(\"\\\"context\\\":\");\n                if(actionsStartIdx>=0 && actionsEndIndex >=0 ) {\n                    var actionsStrInResponse = response.substring(actionsStartIdx, actionsEndIndex).replace(/\\s/g, \"\");//we don't want '\"' right before the 'context'\n                    if(actionsStrInResponse.lastIndexOf(\",\") == actionsStrInResponse.length -1) {//get rid of ','\n                        actionsStrInResponse = actionsStrInResponse.substring(0, actionsStrInResponse.length-1);\n                    } \n                    return JSON.parse(\"{\\\"\"+actionsStrInResponse+\"}\");\n                }\n            }\n        }\n\n        this.getWatchedAction = function(id) {\n            return actionsWatched[id];\n        };\n\n        this.isWatchingForAction = function(reference) {\n            if(typeof reference === \"string\") {\n                return actionsToWatch[reference];\n            }\n            var name = reference.actionName;\n            if($A.util.isAction(reference)) {\n                name = reference.getDef().toString();\n            }\n\n            for(var actionName in actionsToWatch) {\n                if(actionName.includes(name)) {\n                    return actionsToWatch[actionName];\n                }\n            }\n            return null;\n        };\n\n        this.hasWatchedActions = function() {\n            return Object.getOwnPropertyNames(actionsWatched).length > 0;\n        };\n\n        this.isWatchingForActions = function() {\n            return Object.getOwnPropertyNames(actionsToWatch).length > 0;\n        };\n\n        this.setWatchedActionAsProcessed = function(actionId) {\n            delete actionsWatched[actionId];\n\n            // what about actionsToWatch?\n        };\n\n        this.setWatchAsProcessed = function(actionName) {\n            delete actionsToWatch[actionName];\n        };\n\n        this.setWatchedAction = function(action) {\n            actionsWatched[action.getId()] = action;\n        };\n\n        //this.setWatchedAction = function() {};\n        this.watchAction = function(action){\n            actionsToWatch[action.actionName] = action;\n        };\n\n        this.cancelWatchOfAction  = function(actionName) {\n            if(!actionName) { return; }\n\n            if(actionsToWatch.hasOwnProperty(actionName)) {\n                delete actionsToWatch[actionName];\n            }\n        };\n\n        this.cancelWatchOfAllActions = function() {\n            actionsToWatch = {};\n        };\n\n        this.publish = function(key, data) {\n            if(!key) { return; }\n\n            // We batch the post messages\n            // to avoid excessive messages which was causing\n            // stabalization issues.\n            postMessagesQueue.push({\"key\":key, \"data\":data});\n\n            if(batchPostId === null || batchPostId === undefined) {\n                batchPostId = sendQueuedPostMessages();\n            }\n        };\n\n        this.subscribe = function(key, callback) {\n            if(!key || !callback) { return; }\n\n            if(!subscribers[key]) {\n                subscribers[key] = [];\n            }\n\n            subscribers[key].push(callback);\n        };\n\n        this.unsubscribe = function(key, callback) {\n            if(!key || !callback) { return false; }\n\n            if(!subscribers[key]) {\n                return false;\n            }\n\n            var listeners = subscribers[key];\n            subscribers[key] = listeners.filter(function(item){\n                return item !== callback;\n            });\n        };\n\n        // Overriden by some tricky code down below to try to get into the context of the app.\n        this.accessTrap = function(callback) {\n            if(typeof callback === \"function\") {\n                callback();\n            }\n        };\n\n        /**\n         * Get all the top level elements.\n         * This obviously includes $A.getRoot(), but for Lightning Out that is empty.\n         * So we also include all the Disconnected components attached to dom elements.\n         */\n        this.getRootComponents = function() {\n            return ComponentSerializer.getRootComponents();\n        };\n\n        this.getComponent = function(componentId, options) {\n            return ComponentSerializer.getComponent(componentId, options);\n        };\n\n        /**\n         * Increment a counter for the specified key.\n         * @example\n         * $Aura.Inspector.count('rendered');\n         * $Aura.Inspector.count('rendered');\n         * $Aura.Inspector.getCount('rendered'); // 2\n         * @param  {String} key Any unique ID to count\n         */\n        this.count = function(key) {\n            countMap[key] = countMap.hasOwnProperty(key) ? countMap[key] + 1 : 1;\n        };\n\n        /**\n         * Get how many times a key has been counted without incrementing the counter.\n         *\n         * @param  {String} key Unique id to count.\n         */\n        this.getCount = function(key) {\n            return countMap.hasOwnProperty(key) ? countMap[key] : 0;\n        };\n\n        /**\n         * Reset a counted key to 0.\n         *\n         * @param  {String} key Unique id that you passed to this.count(key) to increment the counter.\n         */\n        this.clearCount = function(key) {\n            if(countMap.hasOwnProperty(key)) {\n                delete countMap[key];\n            }\n        };\n\n        // Start listening for messages\n        window.addEventListener(\"message\", Handle_OnPostMessage);\n\n        function Handle_OnPostMessage(event) {\n            if(event && event.data) {\n                if(event.data.action === PUBLISH_KEY) {\n                    callSubscribers(event.data.key, event.data.data);\n                } else if(event.data.action === PUBLISH_BATCH_KEY) {\n                    var data = event.data.data || [];\n                    for (var c = 0, length = data.length; c < length; c++) {\n                        callSubscribers(data[c].key, data[c].data);\n                    }\n                }\n            }\n        }\n\n        function AuraInspector_OnPanelLoad() {\n            if(window.$A) {\n                window.postMessage({\n                    \"action\": \"AuraInspector:bootstrap\",\n                    \"key\":\"AuraInspector:bootstrap\",\n                    \"data\": \"Panel connected, the injected script has already bootstrapped.\"\n                }, window.location.origin);\n            }\n        }\n\n        // This is temporary till we can add the data-ltngout-rendered-by attribute.\n        function getComponentForLtngOut(components) {\n            if(!components.length) { return; }\n            let owner = components[0].getOwner();\n            while(!owner.getOwner().isInstanceOf(\"aura:application\") && owner.getOwner() !== owner) {\n                owner = owner.getOwner();\n            }\n            return owner;\n        }\n\n        function callSubscribers(key, data) {\n            if(subscribers[key]) {\n                subscribers[key].forEach(function(callback){\n                    callback(data);\n                });\n            }\n        }\n\n        function sendQueuedPostMessages() {\n            if(\"requestIdleCallback\" in window) {\n                batchPostId = window.requestIdleCallback(sendQueuedPostMessagesCallback);\n            } else {\n                batchPostId = window.requestAnimationFrame(sendQueuedPostMessagesCallback);\n            }\n\n            function sendQueuedPostMessagesCallback() {\n                if(postMessagesQueue.length) {\n                    try {\n                        window.postMessage({\n                            \"action\": PUBLISH_BATCH_KEY,\n                            \"data\": postMessagesQueue\n                        }, window.location.origin);\n                    } catch(e) {\n                        console.error(\"AuraInspector: Failed to communicate to inspector.\", e);\n                    }\n                }\n                postMessagesQueue = [];\n                batchPostId = null;\n            }\n        }\n\n        function addRightClickObserver(){\n            document.addEventListener(\"mousedown\", function(event){\n                // Right Click\n                if(event.button === 2) {\n                    var current = event.target;\n                    while(current && current != document && !current.hasAttribute(\"data-aura-rendered-by\")) {\n                        current = current.parentNode;\n                    }\n                    lastItemInspected = current;\n                }\n            });\n        }\n\n    }\n\n    function wrapFunction(target, methodName, newFunction) {\n        if(typeof target[methodName] != \"function\") {\n            return;\n        }\n        var original = target[methodName];\n        target[methodName] = function() {\n            newFunction.apply(this, arguments);\n            return original.apply(this, arguments);\n        };\n    }\n\n    function AuraInspector_OnAddHighlightDomNode(globalId) {\n        // Ensure the classes are present that HighlightElement depends on.\n        if(!$Aura.actions[\"AuraDevToolService.AddStyleRules\"].addedStyleRules) {\n            $Aura.actions[\"AuraDevToolService.AddStyleRules\"]();\n            $Aura.actions[\"AuraDevToolService.AddStyleRules\"].addedStyleRules = true;\n        }\n\n        const className = \"auraDevToolServiceHighlight3\";\n        const previous = document.getElementsByClassName(className);\n        for(let d=previous.length-1,current;d>=0;d--){\n            current = previous[d];\n            current.classList.remove(className);\n            current.classList.remove(\"auraDevToolServiceHighlight4\");\n        }\n\n        // Apply the classes to the elements\n        if(globalId) {\n            var cmp = $A.getComponent(globalId);\n            if(cmp && cmp.isValid()) {\n                var elements = cmp.getElements() || [];\n                // todo: add classes to elements\n                for(var c=0,length=elements.length;c<length;c++) {\n                    if(elements[c].nodeType === 1){\n                        elements[c].classList.add(className);\n                    }\n                }\n            }\n        }\n    }\n\n    function AuraInspector_OnRemoveHighlightDomNode() {\n        const removeClassName = \"auraDevToolServiceHighlight3\";\n        const addClassName = \"auraDevToolServiceHighlight4\";\n        const previous = document.getElementsByClassName(removeClassName);\n        for(let d=previous.length-1;d>=0;d--){\n            previous[d].classList.add(addClassName);\n        }\n    }\n\n    function Action_OnFinishAction(config, context) {\n        var startCounts = {\n            \"created\": $Aura.Inspector.getCount(\"component_created\")\n        };\n\n        var ret = config[\"fn\"].call(config[\"scope\"], context);\n\n        var action = config[\"self\"];\n\n        // Only handle Server Actions, its entirely possible for you to $A.enqueueAction() something from the controller.\n        if(!action.getDef().isServerAction()) {\n            return ret;\n        }\n\n        var data = {\n            \"id\": action.getId(),\n            \"state\": action.getState(),\n            \"fromStorage\": action.isFromStorage(),\n            \"returnValue\": JsonSerializer.stringify(action.getReturnValue()),\n            \"error\": JsonSerializer.stringify(action.getError()),\n            \"finishTime\": performance.now(),\n            \"stats\": {\n                \"created\": $Aura.Inspector.getCount(\"component_created\") - startCounts.created\n            }\n        };\n\n        var actionWatched = this.getWatchedAction(action.getId());\n        if(actionWatched) {\n            if(actionWatched.nextError != undefined) {\n                data.howDidWeModifyResponse = \"responseModified_error\";\n            } else if (actionWatched.nextResponse != undefined) {\n                data.howDidWeModifyResponse = \"responseModified_modify\";\n            } else {\n                data.howDidWeModifyResponse = \"responseModified_drop\";\n            }\n\n            this.setWatchedActionAsProcessed(action.getId());\n        }\n\n        this.publish(\"AuraInspector:OnActionStateChange\", data);\n\n        return ret;\n    }\n\n    function AuraInspector_OnActionToWatchEnqueue(data) {\n        if(!data) {\n            console.error(\"AuraDevToolService.AddActionToWatch receive no data from publisher\");\n        }\n        //check if we already has the action in actionsToWatch, if so replace it with the new one\n        var alreadyAdded = this.isWatchingForAction(data);\n\n        if(alreadyAdded) {\n            this.cancelWatchOfAction(data.actionName);\n        } else {\n            //remove the stored response from action storage -- if there is any\n            if(data.actionIsStorable && data.actionIsStorable === true) {\n                var actionsStorage = $A.storageService.getStorage(\"actions\");\n                var actionStorageKey = data.actionStorageKey;//data.actionName+JSON.stringify(data.actionParameter);//\n                if(actionsStorage && actionStorageKey && actionStorageKey.length) {\n                    actionsStorage.get(actionStorageKey)\n                    .then(\n                        function() {\n                            //console.log(\"find storage item for action:\", data);\n                            actionsStorage.remove(actionStorageKey)\n                            .then(function () {\n                                $Aura.Inspector.publish(\"AuraInspector:RemoveStorageData\", {'storageKey': actionStorageKey});\n                            });\n                        },\n                        function(e) {\n                            console.warn(\"cannot find storage item for action:\", data);\n                        }\n                    );\n                }\n            }\n        }\n\n        this.watchAction(data);\n\n        //ask chaos view to create a chaos card\n        /** MOVE:Chaos */\n        if(data.byChaosRun) {\n            var actionName = data.actionName;\n            if (actionName.indexOf(\"ACTION$\") >= 0) {//action could be long, make it more readable\n                actionName = actionName.substr(actionName.indexOf(\"ACTION$\") + 7, actionName.length - 1);\n            }\n            $Aura.Inspector.publish(\"AuraInspector:OnCreateChaosCard\", {\"message\": \"add action \"+actionName+\" to watch list\"} );\n        }\n    }\n\n    function AuraInspector_RemoveActionFromWatch(data) {\n        if(!data) {\n            console.error(\"AuraDevToolService.RemoveActionFromWatch receive no data from publisher\");\n        }\n\n        this.cancelWatchOfAction(data.actionName);\n    }\n\n    /*\n    handler for AuraInspector:OnActionToWatchClear, this will clear up all actions from watch list\n    */\n    function AuraInspector_RemoveActionsFromWatch() {\n        this.cancelWatchOfAllActions();\n    }\n\n    /**\n     * Go through actionToWatch, if we run into an action we are watching, either drop it\n     * or register with actionsWatched, so we can modify response later in onDecode \n     */\n    function ClientService_OnSend(config, auraXHR, actions, method, options) {\n        if (actions) {\n            for(var c=0;c<actions.length;c++) {\n                if(this.isWatchingForActions()) {\n                    var action = actions[c];\n                    var actionToWatch = this.isWatchingForAction(action);\n                    if(actionToWatch) {\n                        //udpate the record of what we are watching, this is mainly for action we want to modify response\n                        if(this.getWatchedAction(action.getId())) {\n                            console.warn(\"Error: we already watching this action:\", action);\n                        } else {\n                            //copy nextResponse to actionWatched\n                            action['nextError'] = actionToWatch.nextError;\n                            action['nextResponse'] = actionToWatch.nextResponse;\n                            action['idtoWatch'] = actionToWatch.actionId;\n                            if(actionToWatch.byChaosRun) {\n                                action['byChaosRun'] = actionToWatch.byChaosRun;\n                            }\n\n                            this.setWatchedAction(action);\n                        }\n\n                        this.setWatchAsProcessed(actionToWatch.actionName);\n                    }\n                }\n\n\n                $Aura.Inspector.publish(\"AuraInspector:OnActionStateChange\", {\n                    \"id\": actions[c].getId(),\n                    \"state\": \"RUNNING\",\n                    \"sentTime\": performance.now()\n                });\n            }\n        }\n\n        var ret = config[\"fn\"].call(config[\"scope\"], auraXHR, actions, method, options);\n\n        return ret;\n    }\n\n    function OnEnqueueAction(config, action, scope) {\n        var ret = config[\"fn\"].call(config[\"scope\"], action, scope);\n\n        if(action.getDef().isServerAction()) {\n            var cmp = action.getComponent();\n            var data =  {\n                \"id\"         : action.getId(),\n                \"params\"     : JsonSerializer.stringify(action.getParams()),\n                \"abortable\"  : action.isAbortable(),\n                \"storable\"   : action.isStorable(),\n                \"background\" : action.isBackground(),\n                \"state\"      : action.getState(),\n                \"isRefresh\"  : action.isRefreshAction(),\n                \"defName\"    : action.getDef()+\"\",\n                \"fromStorage\": action.isFromStorage(),\n                \"enqueueTime\": performance.now(),\n                \"storageKey\" : action.getStorageKey(),\n                \"callingCmp\" : cmp && cmp.getGlobalId()\n            };\n\n            $Aura.Inspector.publish(\"AuraInspector:OnActionEnqueue\", data);\n        }\n        return ret;\n    }\n\n    // function OnFinishAction(config, context) {\n    //     var startCounts = {\n    //         \"created\": $Aura.Inspector.getCount(\"component_created\")\n    //     };\n\n    //     var ret = config[\"fn\"].call(config[\"scope\"], context);\n\n    //     var action = config[\"self\"];\n\n    //     var data = {\n    //         \"id\": action.getId(),\n    //         \"state\": action.getState(),\n    //         \"fromStorage\": action.isFromStorage(),\n    //         \"returnValue\": Serializer.stringify(action.getReturnValue()),\n    //         \"error\": Serializer.stringify(action.getError()),\n    //         \"finishTime\": performance.now(),\n    //         \"stats\": {\n    //             \"created\": $Aura.Inspector.getCount(\"component_created\") - startCounts.created\n    //         }\n    //     };\n\n    //     $Aura.Inspector.publish(\"AuraInspector:OnActionStateChange\", data);\n\n    //     return ret;\n    // }\n\n    function OnAbortAction(config, context) {\n        var ret = config[\"fn\"].call(config[\"scope\"], context);\n\n        var action = config[\"self\"];\n\n        if(action.getDef().isServerAction()) {\n            var data = {\n                \"id\": action.getId(),\n                \"state\": action.getState(),\n                \"finishTime\": performance.now()\n            };\n\n            $Aura.Inspector.publish(\"AuraInspector:OnActionStateChange\", data);\n        }\n\n        return ret;\n    }\n\n    function OnActionRunDeprecated(config, event) {\n        var action = config[\"self\"];\n        var startTime = performance.now();\n        var data = {\n            \"actionId\": action.getId(),\n            \"isServerAction\": action.getDef().isServerAction()\n        };\n\n        $Aura.Inspector.publish(\"AuraInspector:OnClientActionStart\", data);\n\n        var ret = config[\"fn\"].call(config[\"scope\"], event);\n\n        data = {\n            \"actionId\": action.getId(),\n            \"name\": action.getDef().getName(),\n            \"scope\": action.getComponent().getGlobalId()\n        };\n\n        $Aura.Inspector.publish(\"AuraInspector:OnClientActionEnd\", data);\n    }\n\n    function bootstrapCounters() {\n        // Count how many components are being created.\n        $A.installOverride(\"ComponentService.createComponentPriv\", function(){\n             var config = Array.prototype.shift.apply(arguments);\n\n             var ret = config[\"fn\"].apply(config[\"scope\"], arguments);\n\n             $Aura.Inspector.count(\"component_created\");\n\n             return ret;\n        });\n\n        // No way of displaying this at the moment.\n        // wrapFunction($A.Component.prototype, \"render\", function(){\n        //     $Aura.Inspector.count(\"component_rendered\");\n        //     $Aura.Inspector.count(this.getGlobalId() + \"_rendered\");\n        // });\n\n        wrapFunction($A.Component.prototype, \"rerender\", function(){\n            $Aura.Inspector.count(\"component_rerendered\");\n            $Aura.Inspector.count(this.getGlobalId() + \"_rerendered\");\n        });\n\n        /*\n            I'll admit, this is a  hack into the Aura access check framework.\n            I shouldn't rely on this, it's merely a best case scenario work around.\n            Fallbacks should be present if I use this method.\n         */\n        var originalRender = $A.Component.prototype.render;\n        wrapFunction($A.Component.prototype, \"render\", function(){\n            var current = this.getDef();\n            while(current.getSuperDef()) {\n                current = current.getSuperDef();\n            }\n            if(current.getDescriptor().getQualifiedName() === \"markup://aura:application\") {\n                $Aura.Inspector.accessTrap = $A.getCallback(function(callback) {\n                    if(typeof callback === \"function\") {\n                        callback();\n                    }\n                });\n                // No need anymore to do the override. It's simply to attach this access trap.\n                $A.Component.prototype.render = originalRender;\n            }\n        });\n        // No way of displaying this at the moment.\n        // wrapFunction($A.Component.prototype, \"unrender\", function(){\n        //     $Aura.Inspector.count(\"component_unrendered\");\n        //     $Aura.Inspector.count(this.getGlobalId() + \"_unrendered\");\n        // });\n    }\n\n    function bootstrapEventInstrumentation() {\n\n        $A.installOverride(\"Event.fire\", UnStrictApis.OnEventFire.bind($Aura, output));\n\n        function output(data) {\n            var componentToJSON = $A.Component.prototype.toJSON;\n            delete $A.Component.prototype.toJSON;\n\n            var json = JsonSerializer.stringify(data, function(key, value){\n                if($A.util.isComponent(value)) {\n                    return \"[Component] {\" + value.getGlobalId() + \"}\";\n                } else if(value instanceof Function) {\n                    return value +\"\";\n                }\n                return value;\n            });\n\n            $A.Component.prototype.toJSON = componentToJSON;\n\n            return json;\n        }\n    }\n\n    function bootstrapTransactionReporting() {\n        $A.metricsService.enablePlugins();\n\n        $A.metricsService.transactionStart(\"AuraInspector\", \"transactionstab\");\n\n        $A.metricsService.onTransactionEnd(function(transaction){\n            setTimeout(() => {\n                $Aura.Inspector.publish(\"AuraInspector:OnTransactionEnd\", transaction);\n            }, 0);\n        });\n\n        $A.metricsService.onTransactionsKilled(function(transactions){\n            if(transactions) {\n                for(var c=0;c<transactions.length;c++) {\n                    if(transactions[c].id === \"AuraInspector:transactionstab\") {\n                        $A.metricsService.transactionStart(\"AuraInspector\", \"transactionstab\");\n                    }\n                }\n            }\n        });\n    }\n\n\n    function bootstrapPerfDevTools() {\n        $A.PerfDevToolsEnabled = true;\n\n        var OPTIONS = {\n                componentCreation  : true,\n                componentRendering : true,\n                timelineMarks      : false,\n                transactions       : true,\n            },\n            CMP_CREATE_MARK   = 'componentCreation',\n            START_SUFIX       = 'Start',\n            END_SUFIX         = 'End',\n            CMP_CREATE_END    = CMP_CREATE_MARK + END_SUFIX,\n            SAMPLING_INTERVAL = 0.025;\n\n\n        $A.PerfDevTools = {\n            init: function (cfg) {\n                cfg || (cfg = {});\n                this._initializeOptions(cfg);\n                this._hooks = {};\n                this.collector = {\n                    componentCreation : [],\n                    rendering: []\n                };\n                this._initializeHooks();\n            },\n            clearMarks: function (marks) {\n                this._resetCollector(marks);\n            },\n            _initializeOptions: function (cfg) {\n                this.opts = {\n                    componentCreation  : cfg.componentCreation  || OPTIONS.componentCreation,\n                    componentRendering : cfg.componentRendering || OPTIONS.componentRendering,\n                    timelineMarks      : typeof cfg.timelineMarks === 'boolean' ? cfg.timelineMarks : OPTIONS.timelineMarks,\n                    transactions       : cfg.transactions || OPTIONS.transactions\n                };\n            },\n            _initializeHooks: function () {\n                if (this.opts.componentCreation /* && $A.getContext().mode !== 'PROD'*/) {\n                    this._initializeHooksComponentCreation();\n                }\n            },\n            _createNode: function (name, mark, id) {\n                return {\n                    id  : id,\n                    mark: mark,\n                    name: name,\n                    timestamp: window.performance.now(),\n                };\n            },\n            _resetCollector: function (type) {\n                if (type) {\n                    this.collector[type] = [];\n                    return;\n                }\n\n                for (var i in this.collector) {\n                    this.collector[i] = [];\n                }\n            },\n            _initializeHooksComponentCreation: function () {\n                this._hookOverride(\"ComponentService.createComponentPriv\", CMP_CREATE_MARK);\n            },\n            getComponentCreationProfile: function () {\n                return this._generateCPUProfilerDataFromMarks(this.collector.componentCreation);\n            },\n            _hookOverride: function(key, mark) {\n                $A.installOverride(key, function(){\n                    var config = Array.prototype.shift.apply(arguments);\n                    var args = Array.prototype.slice.apply(arguments);\n                    var cmpConfig = arguments[0];\n                    var callback = arguments[1];\n                    var descriptor = $A.util.isString(cmpConfig) ? cmpConfig : (cmpConfig[\"componentDef\"][\"descriptor\"] || cmpConfig[\"componentDef\"]) + '';\n\n                    var collector = this.collector[mark];\n                    collector.push(this._createNode(descriptor, mark + START_SUFIX));\n\n                    // When there is a callback, no return value is provided.\n                    // The return value is passed to the callback in this case. \n                    if(typeof callback === \"function\") {\n                        args[1] = (newCmp, status, message) => {\n                            if(newCmp) {\n                                var id = newCmp.getGlobalId && newCmp.getGlobalId() || \"([ids])\";\n                                collector.push(this._createNode(descriptor, mark + END_SUFIX, id));\n                            }\n                            callback(newCmp, status, message);\n                        };\n                    }\n\n                    var ret = config[\"fn\"].apply(config[\"scope\"], args);\n\n                    if(ret !== undefined) { \n                        var id = ret.getGlobalId && ret.getGlobalId() || \"([ids])\";\n                        collector.push(this._createNode(descriptor, mark + END_SUFIX, id));\n                    }\n                    return ret;\n\n                }.bind(this), this);\n            },\n            _hookMethod: function (host, methodName, mark) {\n                var self = this;\n                var hook = host[methodName];\n                var collector = this.collector[mark];\n\n                this._hooks[methodName] = hook;\n                host[methodName] = function (config) {\n                    if (Array.isArray(config)) {\n                        return hook.apply(this, arguments);\n                    }\n\n                    var descriptor = (config.componentDef.descriptor || config.componentDef) + '',\n                        collector  = self.collector[mark];\n\n                    // Add mark\n                    collector.push(self._createNode(descriptor, mark + START_SUFIX));\n\n                    // Hook!\n                    var result = hook.apply(this, arguments);\n                    var id = result.getGlobalId && result.getGlobalId() || '([ids])';\n\n                    // End mark\n                    collector.push(self._createNode(descriptor, mark + END_SUFIX, id));\n                    return result;\n                };\n            },\n            _generateCPUProfilerDataFromMarks: function (marks) {\n                if(!marks || !marks.length) { return {}; }\n\n                //global stuff for the id\n                var id = 0;\n                function nextId () {return ++id;}\n                function logTree(stack, mark) {\n                    // UNCOMMENT THIS FOR DEBUGGING PURPOSES:\n                    // var d = '||| ';\n                    // console.log(Array.apply(0, Array(stack)).map(function(){return d;}).join(''), mark);\n                }\n\n                function hashCode(name) {\n                    var hash = 0, i, chr, len;\n                    if (name.length == 0) return hash;\n                    for (i = 0, len = name.length; i < len; i++) {\n                        chr   = name.charCodeAt(i);\n                        hash  = ((hash << 5) - hash) + chr;\n                        hash |= 0; // Convert to 32bit integer\n                    }\n                    return Math.abs(hash);\n                }\n\n                function generateNode (name, options) {\n                    options || (options = {});\n                    return  {\n                        functionName: name || (\"Random.\" + Math.random()),\n                        scriptId: \"3\",\n                        url: options.details || \"\",\n                        lineNumber: 0,\n                        columnNumber: 0,\n                        hitCount: options.hit || 0,\n                        callUID: hashCode(name),\n                        children: [],\n                        deoptReason: \"\",\n                        id: nextId()\n                    };\n                }\n\n                var endText    = CMP_CREATE_END,\n                    startTime  = marks[0].timestamp, // Get from first and last mark\n                    endTime    = marks[marks.length - 1].timestamp,\n                    markLength = marks.length,\n                    duration   = endTime - startTime,\n                    sampling   = SAMPLING_INTERVAL,\n                    root       = generateNode(\"(root)\"),\n                    idle       = generateNode(\"(idle)\"),\n                    current    = generateNode(marks[0].name),\n                    stack      = [current, root];\n\n                current._startTime = marks[0].timestamp;\n\n                function generateTimestamps(startTime, endTime) {\n                    var diff  = endTime - startTime,\n                        ticks = Math.round(diff / sampling), // every N miliseconds\n                        time  = startTime,\n                        ts    = [time];\n\n                    for (var i = 1; i < ticks; i++) {\n                        time += sampling;\n                        ts.push(time);\n                    }\n                    return ts;\n                }\n\n                function generateSamples (root, size, idle) {\n                    var samples = new Array(size).join(\",\"+idle.id).split(idle.id);\n                        samples[0] = idle.id;\n                    var currentIndex = 0;\n                    var idleHits = 0;\n\n\n                    function calculateTimesForNode(node) {\n                        if (node._idleHits) {\n                            currentIndex += node._idleHits;\n                            idleHits += node._idleHits;\n                        }\n\n                        for (var i = 0; i < node.hitCount; i++) {\n                            samples[currentIndex + i] = node.id;\n                        }\n                        currentIndex += node.hitCount;\n\n                        for (var j = 0; j < node.children.length; j++) {\n                            calculateTimesForNode(node.children[j]);\n                        }\n\n                    }\n                    calculateTimesForNode(root, root.id);\n                    idle.hitCount = Math.max(0, size - currentIndex + idleHits); //update idle with remaining hits\n                    return samples;\n                }\n\n                logTree(stack.length - 1, 'open: ' + marks[0].name);\n                for (var i = 1; i < markLength; i++) {\n                    var tmp = marks[i];\n                    if (stack[0].functionName === tmp.name && tmp.mark === endText) {\n                        var tmpNode = stack.shift();\n                        tmpNode._endTime = tmp.timestamp;\n                        tmpNode._totalTime = tmpNode._endTime - tmpNode._startTime;\n                        tmpNode._childrenTime = tmpNode.children.reduce(function (p, c) {return p + c._totalTime;}, 0);\n                        tmpNode._selfTime = tmpNode._totalTime - tmpNode._childrenTime;\n                        tmpNode.hitCount = Math.floor(tmpNode._selfTime / sampling);\n                        tmpNode._cmpId = tmp.id;\n                        tmpNode._childComponentCount += tmpNode.children.length;\n\n                        //push into the parent\n                        stack[0].children.push(tmpNode);\n                        stack[0]._childComponentCount += tmpNode._childComponentCount;\n                        logTree(stack.length, 'close: ' + tmp.name + ' selfTime: ' + tmpNode._selfTime.toFixed(4) + '| totalTime: ' + tmpNode._totalTime.toFixed(4));\n                    } else {\n\n                        current = generateNode(tmp.name);\n                        current._startTime = tmp.timestamp;\n                        current._childComponentCount = 0;\n                        if (stack.length === 1 && ((markLength - i) > 1)) {\n                            current._idleHits = Math.floor((tmp.timestamp - marks[i - 1].timestamp) / sampling);\n                        }\n\n                        stack.unshift(current);\n                        logTree(stack.length - 1, 'open: ' + tmp.name);\n                    }\n                }\n                root.children.push(idle);\n                var timestamp = generateTimestamps(startTime, endTime);\n                var samples = generateSamples(root, timestamp.length, idle);\n\n                return {\n                    head: root,\n                    startTime: startTime / 1000,\n                    endTime : endTime / 1000,\n                    timestamp: timestamp,\n                    samples : samples,\n                };\n            }\n        };\n    };\n\n","const ControlCharacters = {\n    \"COMPONENT_CONTROL_CHAR\" : \"\\u263A\", // ☺ - This value is a component Global Id\n    \"ACTION_CONTROL_CHAR\" : \"\\u2744\", // ❄ - This is an action\n    \"ESCAPE_CHAR\" : \"\\u2353\", // ⍓ This value was escaped, unescape before using.\n    //\"UNDEFINED_CHAR\" : \"\\u2349\", // ⍉ Was literally undefined,\n    //\"NULL_CHAR\": \"\\u2400\", // ␀Was literally null\n\n    isComponentId(id) {\n        return typeof id == \"string\" && id.startsWith(ControlCharacters.COMPONENT_CONTROL_CHAR);\n    },\n\n    isActionId(id) {\n        return typeof id == \"string\" && id.startsWith(ControlCharacters.ACTION_CONTROL_CHAR);\n    },\n\n    getCleanId(id) {\n        if(typeof id !== \"string\") { return id; }\n        if(this.isComponentId(id) || this.isActionId(id) || id.substring(0, 1) == ControlCharacters.ESCAPE_CHAR) {\n            return id.substring(1);\n        }\n        return id;\n    }\n\n};\n\nObject.freeze(ControlCharacters);\n\nexport default ControlCharacters;\n","import ControlCharacters from \"./ControlCharacters.js\";\n\nlet increment = 1;\n\nexport default class JsonSerializer {\n    /**\n     * Safe because it handles circular references in the data structure.\n     *\n     * Will add control characters and shorten components to just their global ids.\n     * Formats DOM elements in a pretty manner.\n     */\n    static stringify(originalValue) {\n        // For circular dependency checks\n        var doNotSerialize = {\n            \"[object Window]\": true,\n            \"[object global]\": true,\n            \"__proto__\": null\n        };\n        var visited = new Set();\n        var toJSONCmp = $A.Component.prototype.toJSON;\n        delete $A.Component.prototype.toJSON;\n        var result = \"{}\";\n        try {\n            result = JSON.stringify(originalValue, function(key, value) {\n                if(value === document) { return {}; }\n                if(Array.isArray(this) || key) { value = this[key]; }\n                if(!value) { return value; }\n\n                if(typeof value === \"string\" && (value.startsWith(ControlCharacters.COMPONENT_CONTROL_CHAR) || value.startsWith(ControlCharacters.ACTION_CONTROL_CHAR))) {\n                    return ControlCharacters.ESCAPE_CHAR + escape(value);\n                }\n\n                if(value instanceof Error) {\n                    return value+\"\";\n                }\n\n                if(value instanceof HTMLElement) {\n                    var attributes = value.attributes;\n                    var domOutput = [];\n                    for(var c=0,length=attributes.length,attribute;c<length;c++) {\n                        attribute = attributes.item(c);\n                        domOutput.push(attribute.name + '=\"' + attribute.value + '\"');\n                    }\n                    return `<${value.tagName} ${domOutput.join(' ')}>`; // Serialize it specially.\n                }\n\n                if(value instanceof Text) {\n                    return value.nodeValue;\n                }\n\n                // TODO: Consider handling invalid components differently.\n                if($A.util.isComponent(value)) {\n                    if(value.isValid()) {\n                        return ControlCharacters.COMPONENT_CONTROL_CHAR + value.getGlobalId();\n                    } else {\n                        return value.toString();\n                    }\n                }\n\n                if($A.util.isExpression(value)) {\n                    return value.toString();\n                }\n\n                if($A.util.isAction(value)) {\n                    return ControlCharacters.ACTION_CONTROL_CHAR + value.getDef().toString();\n                }\n\n                if(Array.isArray(value)) {\n                    return value.slice();\n                }\n\n                if(typeof value === \"object\") {\n                    if(\"$serId$\" in value && visited.has(value)) {\n                        return {\n                            \"$serRefId$\": value[\"$serId$\"],\n                            \"__proto__\": null\n                        };\n                    }\n                    else if(doNotSerialize[Object.prototype.toString.call(value)]) {\n                        value = {};\n                    }\n                    else if(!Object.isSealed(value) && !$A.util.isEmpty(value)) {\n                        visited.add(value);\n                        value.$serId$ = increment++;\n                    }\n                }\n\n                if(typeof value === \"function\") {\n                    return value.toString();\n                }\n\n                return value;\n            });\n\n        } catch(e) {\n            console.error(\"AuraInspector: Error serializing object to json.\", e);\n        }\n\n        visited.forEach(function(item){\n            if(\"$serId$\" in item) {\n                delete item[\"$serId$\"];\n            }\n        });\n\n        $A.Component.prototype.toJSON = toJSONCmp;\n\n        return result;\n    };\n\n    /** \n     * \n     */\n    static parse(json) {\n        if(json === undefined || json === null) {\n            return json;\n        }\n        \n        return resolve(JSON.parse(json));\n    }\n}\n\n\n/**\n * TODO: When to use this\n */\nfunction resolve(object) {\n        if(!object) { return object; }\n\n        var count = 0;\n        var serializationMap = new Map();\n        var unresolvedReferences = [];\n\n        function innerResolve(current, parent, property) {\n            if(!current) { return current; }\n            if(typeof current === \"object\") {\n                if(current.hasOwnProperty(\"$serRefId$\")) {\n                    if(serializationMap.has(current[\"$serRefId$\"])) {\n                        return serializationMap.get(current[\"$serRefId$\"]);\n                    } else {\n                        // Probably Out of order, so we'll do it after scanning the entire tree\n                        unresolvedReferences.push({ parent: parent, property: property, $serRefId$: current[\"$serRefId$\"] });\n                        return current;\n                    }\n                }\n\n                if(current.hasOwnProperty(\"$serId$\")) {\n                    serializationMap.set(current[\"$serId$\"], current);\n                    delete current[\"$serId$\"];\n                }\n\n                for(var property in current) {\n                    if(current.hasOwnProperty(property)) {\n                        if(typeof current[property] === \"object\") {\n                            current[property] = innerResolve(current[property], current, property);\n                        }\n                    }\n                }\n            }\n            return current;\n        }\n\n        object = innerResolve(object);\n\n        // If we had some resolutions out of order, lets clean those up now that we've parsed everything that is serialized.\n        var unresolved;\n        for(var c=0,length=unresolvedReferences.length;c<length;c++) {\n            unresolved = unresolvedReferences[c];\n            unresolved.parent[unresolved.property] = serializationMap.get(unresolved[\"$serRefId$\"]);\n        }\n\n        return object;\n    }","\nimport JsonSerializer from \"../JsonSerializer.js\";\n\nexport default class ComponentSerializer {\n    \"use strict\";\n    \n    /**\n     * Get all the top level elements.\n     * This obviously includes $A.getRoot(), but for Lightning Out that is empty.\n     * So we also include all the Disconnected components attached to dom elements.\n     */\n    static getRootComponents() {\n        var topLevelDomNodes = null;\n        var rootNodes = [];\n        try {\n            var app = $A.getRoot();\n            rootNodes.push({\n                \"id\": app.getGlobalId(),\n                \"components\": [this.getComponent(app.getGlobalId())]\n            });\n\n            if(app.isInstanceOf(\"ltng:outApp\")) {\n                topLevelDomNodes = document.querySelectorAll(\"[data-ltngout-rendered-by]\");\n\n                var map = {};\n                var parentNodes = [];\n\n                topLevelDomNodes.forEach(node => {\n                    const id = node.getAttribute(\"data-ltngout-rendered-by\");\n                    const component = $A.getComponent(id);\n\n                    rootNodes.push({\n                        \"dom\": node,\n                        \"id\": \"data-ltngout-rendered-by$\" + id,\n                        \"components\": [this.getComponent(id, {\"body\": false })]\n                    });\n                });\n\n            }\n        } catch(e) {\n        }\n\n        return JsonSerializer.stringify(rootNodes);\n    }\n\n    static getComponent(componentId, options) {\n        var component = $A.util.isComponent(componentId) ? componentId : $A.getComponent(componentId);\n        var configuration = Object.assign({\n            \"attributes\": true, // True to serialize the attributes, if you just want the body you can set this to false and body to true. (Good for serializing supers)\n            \"body\": true, // Serialize the Body? This can be expensive so you can turn it off.\n            \"elementCount\": false, // Count all child elements of all the elements associated to a component.\n            \"model\": false, // Serialize the model data as well\n            \"valueProviders\": false, // Should we serialize the attribute and facet value providers to the output? Could be a little slow now since we serialize passthrough value keys which could be big objects.\n            \"handlers\": false // Do we serialize the event handlers this component is subscribed to?\n        }, options);\n        if(component){\n            // TODO: Consider removing this, will no longer gack.\n            if(!component.isValid()) {\n                return JSON.stringify({\n                    \"valid\": false,\n                    \"__proto__\": null // no inherited properties\n                });\n            } else {\n                // This api is added by us in an override. If it's not there when we try to serialize a component we'll have issues.\n                // So if its not there, just run the bootstrap code.\n                if(!(\"_$getSelfGlobalId$\" in component)){\n                    // Adds the _$getSelfGlobalId$ to Component prototype\n                    try {\n                        $A.installOverride(\"outputComponent\", function(){});\n                    } catch(e){}\n                }\n                var isTypeModule = isModule(component);\n                var output = {\n                    \"descriptor\": component.getDef().getDescriptor().toString(),\n                    \"globalId\": component._$getSelfGlobalId$(),\n                    \"rendered\": component.isRendered(),\n                    \"isConcrete\": component.isConcrete(),\n                    \"valid\": component.isValid(),\n                    \"expressions\": {},\n                    \"attributes\": {},\n                    \"__proto__\": null, // no inherited properties\n                    \"elementCount\": 0,\n                    // TODO: Implement properly or remove.\n                    \"rerender_count\": 0, //this.getCount(component._$getSelfGlobalId$() + \"_rerendered\")\n                    \"isModule\": isTypeModule\n\n                    // Added Later\n                    //,\"super\": \"\"\n                    //,\"model\": null\n                };\n\n                if(!isTypeModule) {\n                    // Throws an exception when used on an InteropComponent\n                    output[\"localId\"] = component.getLocalId();\n                }\n\n                // VALUE PROVIDERS\n                if(configuration.valueProviders) {\n                    output[\"attributeValueProvider\"] = getValueProvider(component.getAttributeValueProvider());\n                    output[\"facetValueProvider\"] = getValueProvider(component.getComponentValueProvider());\n                }\n\n                // ATTRIBUTES\n                if(!isTypeModule && configuration.attributes) {\n                    var auraError=$A.error;\n                    var attributes = component.getDef().getAttributeDefs();\n\n                    try {\n                        // The Aura Inspector isn't special, it doesn't\n                        // have access to the value if the access check\n                        // system prevents it. So we should notify we\n                        // do not have access.\n                        var accessCheckFailed;\n\n                        // Track Access Check failure on attribute access\n                        $A.error=function(message,error){\n                            if(message.indexOf(\"Access Check Failed!\")===0){\n                                accessCheckFailed = true;\n                            }\n                        };\n\n                        attributes.each(function(attributeDef) {\n                            var key = attributeDef.getDescriptor().getName();\n                            var value;\n                            var rawValue;\n                            accessCheckFailed = false;\n\n                            // BODY\n                            // If we don't want the body serialized, skip it.\n                            // We would only want the body if we are going to show\n                            // the components children.\n                            if(key === \"body\" && !configuration.body) { return; }\n                            try {\n                                rawValue = component._$getRawValue$(key);\n                                value = component.get(\"v.\" + key);\n                            } catch(e) {\n                                value = undefined;\n                            }\n\n                            if(value === undefined || value === null) {\n                                value = value+\"\";\n                            }\n\n                            if($A.util.isExpression(rawValue)) {\n                                output.expressions[key] = rawValue+\"\";\n                                output.attributes[key] = accessCheckFailed ? \"[ACCESS CHECK FAILED]\" : value;\n                            } else {\n                                output.attributes[key] = rawValue;\n                            }\n                        }.bind(this));\n                    } catch(e) {\n                        console.error(e);\n                    } finally {\n                        $A.error = auraError;\n                    }\n                }\n                // BODY\n                else if(configuration.body) {\n                    var rawValue;\n                    var value;\n                    try {\n                        rawValue = component._$getRawValue$(\"body\");\n                        value = component.get(\"v.body\");\n                    } catch(e) {\n                        value = undefined;\n                    }\n\n                    if(value === undefined || value === null) {\n                        value = value+\"\";\n                    }\n                    \n                    if($A.util.isExpression(rawValue)) {\n                        output.expressions[\"body\"] = rawValue+\"\";\n                        output.attributes[\"body\"] = value;\n                    } else {\n                        output.attributes[\"body\"] = rawValue;\n                    }\n                }\n\n                var supers = [];\n                var superComponent = component;\n                while(superComponent = superComponent.getSuper()) {\n                    supers.push(superComponent._$getSelfGlobalId$());\n                }\n\n                if(supers.length) {\n                    output[\"supers\"] = supers;\n                }\n\n                // ELEMENT COUNT\n                // Concrete is the only one with elements really, so doing it at the super\n                // level is duplicate work.\n                if(component.isConcrete() && configuration.elementCount) {\n                    var elements = component.getElements() || [];\n                    var elementCount = 0;\n                    for(var c=0,length=elements.length;c<length;c++) {\n                        if(elements[c] instanceof HTMLElement) {\n                            // Its child components, plus itself.\n                            elementCount += elements[c].getElementsByTagName(\"*\").length + 1;\n                        }\n                    }\n                    output.elementCount = elementCount;\n                }\n\n                // MODEL\n                if(configuration.model) {\n                    var model = component.getModel();\n                    if(model) {\n                        output[\"model\"] = model.data;\n                    }\n                }\n\n                // HANDLERS\n                if(configuration.handlers){\n                    var handlers = {};\n                    var events = component.getEventDispatcher();\n                    var current;\n                    var apiSupported = true; // 204+ only. Don't want to error in 202. Should remove this little conditional in 204 after R2.\n                    for(var eventName in events) {\n                        current = events[eventName];\n                        if(Array.isArray(current) && current.length && apiSupported) {\n                            handlers[eventName] = [];\n                            for(var c=0;c<current.length;c++){\n                                if(!current[c].hasOwnProperty(\"actionExpression\")) {\n                                    apiSupported = false;\n                                    break;\n                                }\n                                handlers[eventName][c] = {\n                                    \"expression\": current[c][\"actionExpression\"],\n                                    \"valueProvider\": getValueProvider(current[c][\"valueProvider\"])\n                                };\n                            }\n                        }\n                    }\n                    if(apiSupported) {\n                        output[\"handlers\"] = handlers;\n                    }\n                }\n\n                // Output to the dev tools\n                return JsonSerializer.stringify(output);\n            }\n        }\n        return \"\";\n    };\n\n}\n\n/** Serializing Passthrough Values as valueProviders is a bit complex, so we have this helper function to do it. */\nfunction getValueProvider(valueProvider) {\n    if(\"_$getSelfGlobalId$\" in valueProvider) {\n        return valueProvider._$getSelfGlobalId$();\n    }\n\n    // Probably a passthrough value\n    const output = {\n        // Can't do providers yet since we don't have a way to get access to them.\n        // We should though, it would be great to see in the inspector.\n        //\"providers\": safeStringify()\n        $type$: \"passthrough\"\n    };\n\n    if('getPrimaryProviderKeys' in valueProvider) {\n        const values = {};\n        let value;\n        let keys;\n        let provider = valueProvider;\n        while(provider && !(\"_$getSelfGlobalId$\" in provider)) {\n            keys = provider.getPrimaryProviderKeys();\n            for(var c = 0; c<keys.length;c++) {\n                let key = keys[c];\n                if(!values.hasOwnProperty(key)) {\n                    value = provider.get(key);\n                    if($A.util.isComponent(value)) {\n                        values[key] = {\n                            \"id\": value\n                        };\n                    } else {\n                        values[key] = value;\n                    }\n                }\n            }\n            provider = provider.getComponent();\n        }\n        if(provider && \"_$getSelfGlobalId$\" in provider) {\n            output[\"globalId\"] = provider._$getSelfGlobalId$();\n        }\n        output[\"values\"] = values;\n    } else {\n        while(!(\"_$getSelfGlobalId$\" in valueProvider)) {\n            valueProvider = valueProvider.getComponent();\n        }\n        output[\"globalId\"] = valueProvider._$getSelfGlobalId$();\n    }\n\n    return output;\n}\n\n// This is temporary till we can add the data-ltngout-rendered-by attribute.\nfunction getComponentForLtngOut(components) {\n    if(!components.length) { return; }\n    let owner = components[0].getOwner();\n    while(!owner.getOwner().isInstanceOf(\"aura:application\") && owner.getOwner() !== owner) {\n        owner = owner.getOwner();\n    }\n    return owner;\n}\n\nfunction isModule(component) {\n    if(!component) {\n        return false;\n    }\n\n    const toString = component.toString();\n\n    return toString === \"InteropComponent\" || toString.startsWith(\"InteropComponent:\");\n}\n\n\n","/** \n * This file is included in the InjectedScript, but is not run through the es2015 transform. \n * So all this code is not included in a use_strict directive, or transpiled.\n */\n\n/** Doesn't work when used with use_strict */\nexports.OnEventFire = function OnEventFire(output, config, params) {\n    var startTime = performance.now();\n    var eventId = \"event_\" + startTime;\n    var data = {\n        \"id\": eventId\n    };\n\n    this.Inspector.publish(\"AuraInspector:OnEventStart\", data);\n\n    var ret = config[\"fn\"].call(config[\"scope\"], params);\n\n    var event = config[\"scope\"];\n    var source = event.getSource();\n\n    data = {\n        \"id\": eventId,\n        \"name\": event.getDef().getDescriptor().getQualifiedName(),\n        \"parameters\": output(event.getParams()),\n        \"sourceId\": source ? source.getGlobalId() : \"\",\n        \"startTime\": startTime,\n        \"endTime\": performance.now(),\n        \"type\": event.getDef().getEventType()\n    };\n\n    // Having troubles with this in strict mode.\n    // Should probably either remove this, or disable the use strict.\n    try {\n        data[\"caller\"] = arguments.callee.caller.caller.caller+\"\";\n    } catch(e) {}\n\n    this.Inspector.publish(\"AuraInspector:OnEventEnd\", data);\n\n    return ret;\n}"],"sourceRoot":""}